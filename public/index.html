<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="manifest" href="manifest.json">
<title>Jungle Militia</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div id="ui-layer">
  <!-- HOME SCREEN -->
  <div id="home-screen" class="screen">
    <h1 class="title-large">JUNGLE MILITIA</h1>
    <button class="btn-menu" onclick="ui.showLobby(true)">Start Game</button>
    <button class="btn-menu" onclick="ui.showLobby(false)">Join Game</button>
    <button class="btn-menu" onclick="ui.showGarage()">Garage</button>
    <div style="margin-top:20px; color:#aaa; font-size: 0.8em;">v2.0 - REFORGED</div>
  </div>

  <!-- GARAGE SCREEN -->
  <div id="garage-screen" class="screen hidden">
    <div class="panel">
      <h2>VEHICLE DEPOT</h2>
      <div id="garage-grid">
        <!-- Generated by JS -->
      </div>
      <div style="margin-top:20px;">
        <button class="btn-menu" onclick="ui.showHome()">BACK</button>
      </div>
    </div>
  </div>

  <!-- LOBBY SCREEN -->
  <div id="lobby-screen" class="screen hidden">
    <div class="panel">
      <h2 id="lobby-title">MISSION BRIEFING</h2>
      <div class="setup-grid">
        <div class="form-group">
          <label for="map-select">BATTLEFIELD</label>
          <select id="map-select">
            <option value="0">DEEP JUNGLE (Balanced)</option>
            <option value="1">RIVER DELTA (Water)</option>
            <option value="2">MOUNTAIN BASE (Choke Points)</option>
            <option value="3">ARENA (Open)</option>
            <option value="4">DENSE THICKET (Maze)</option>
          </select>
        </div>
        <div class="form-group">
          <label for="ally-count">SQUAD SUPPORT</label>
          <select id="ally-count">
            <option value="0">SOLO OP</option>
            <option value="1">1 WINGMAN</option>
            <option value="2">2 WINGMEN</option>
            <option value="3">FULL SQUAD</option>
          </select>
        </div>
      </div>

      <div id="join-code-area" style="display:none; margin-bottom:15px;">
        <label for="room-code-input">ENTER ROOM CODE:</label>
        <input type="text" id="room-code-input" placeholder="e.g. A7X9" style="text-transform:uppercase; text-align:center; letter-spacing: 5px;" autocomplete="off" autocapitalize="characters">
      </div>

      <div id="lobby-info" style="margin-bottom:15px; display:none;">
        <label>ROOM CODE: <span id="display-room-code" style="color:var(--primary)">---</span></label>
        <div id="lobby-players-list"></div>
      </div>

      <div class="row" style="justify-content:center;">
        <button class="btn-menu" style="background:#c0392b" onclick="ui.showHome()">ABORT</button>
        <button class="btn-menu" id="lobby-action-btn" onclick="game.startRequest()">DEPLOY</button>
      </div>
    </div>
  </div>

  <!-- GAME OVER SCREEN -->
  <div id="game-over-screen" class="screen hidden" style="background:rgba(0,0,0,0.85)">
    <h1 class="title-large" style="color:#e74c3c">M.I.A.</h1>
    <h2 id="final-score">SCORE: 0</h2>
    <button class="btn-menu" onclick="location.reload()">RTB (RELOAD)</button>
  </div>
</div>

<!-- GAME HUD -->
<div id="game-ui">
  <canvas id="gameCanvas"></canvas>

  <div id="overlay-msg"></div>

  <div class="hud-panel top-left">
    <div class="bar-wrap">
      <div class="bar-text">ARMOR</div>
      <div id="hp-bar" class="bar-fill hp-fill" style="width:100%"></div>
      <div id="shield-bar" class="bar-fill shield-fill" style="width:0%"></div>
    </div>
    <div class="bar-wrap" style="height:10px; border-color:#555;">
      <div id="stress-bar" class="bar-fill" style="width:0%; background:#fff;"></div>
    </div>
    <div style="color:var(--primary); font-size:20px; text-shadow:2px 2px 0 #000;">
      PTS: <span id="score-val">0</span>
    </div>
  </div>

  <div class="hud-panel top-center">
    <div style="font-size:24px; color:#fff;">WAVE <span id="wave-val">1</span></div>
    <div style="width:200px; height:6px; background:#222; border:1px solid #555; margin-top:5px;">
      <div id="threat-bar" style="height:100%; width:0%; background:var(--danger);"></div>
    </div>
  </div>

  <div class="hud-panel top-right">
    <canvas id="minimap" role="img" aria-label="Minimap showing player and enemy positions"></canvas>
  </div>

  <!-- Mobile Controls -->
  <div id="joystick-move" class="joystick-area left" style="left:40px;">
    <div id="knob-move" class="joystick-knob" style="background:var(--primary); border:2px solid #fff;"></div>
  </div>

  <div id="joystick-shoot" class="joystick-area right" style="right:40px; border-color:rgba(231,76,60,0.5);">
    <div id="knob-shoot" class="joystick-knob" style="background:var(--danger); border:2px solid #fff;"></div>
  </div>

  <button id="dash-btn" type="button" class="dash-icon" aria-label="Dash">DASH</button>
  <button id="ability-btn" type="button" class="ability-icon" aria-label="Activate Ability">SKILL</button>

  <div id="notification-area" style="position:absolute; top:120px; left:0; width:100%; text-align:center; pointer-events:none;"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="game.js"></script>
</body>
</html>